---
layout: post
title: 타입스크립트가 타입을 검사하는 방법
categories: [Typescript]
tags: []
fullview: false
comments: true
---

### Intro
취업을 하기 전에는 자바스크립트와 리액트를 활용하여 프로젝트를 진행했었다. 다른 사람들과 협업을 하는데 있어서 큰 불편함을 느끼지는 못했다. 하지만 다른 사람이 개발한 컴포넌트를 사용하게 될 때 전달하는 props의 변수명만 보고 어떠한 값을 전달해야할지 찾아봐야했다. 이를 해결하기위해 PropTypes를 도입하기도 했었다.


이제 취업을 하고 회사에서는 기본적으로 타입스크립트와 리액트를 활용하여 개발을 진행한다. 첫 프로젝트를 진행할 때 다른 분들의 코드를 보면서 어찌어찌 타입스크립트를 도입하기는 했지만 스스로 빈 깡통과 같은 느낌을 받았다. 어떻게 동작하는지, 어떻게 타입을 정의할 수 있는지 등을 자세히 알지 못하고 다른 사람의 코드를 보고 따라하기 바빴다.


그렇기 때문에 먼저 타입스크립트가 어떻게 타입을 검사하는지 공부를 해보려고 한다.
자바스크립트는 런타임 환경에서 타입이 결정되기 때문에 아래의 코드처럼 실행 도중에 에러를 발생시킬 수 있다.
```javascript
function add(a, b) {
	return a + b;
}

const total = add('a' + 5);
```


위의 코드에서 add 함수는 두 개의 정수를 입력받아 더한 값을 반환하는 역할을 한다. 하지만 실수로 영문자와 정수를 전달한다면 정수가 문자열로 반환하여 "a5"를 반환하게된다. 만약 런타임 이전에 add 함수의 매개변수 a, b의 타입이 정수로 정해졌다면 미리 실수를 알 수 있었을 것이다.


이처럼 타입을 검사하는 타입스크립트를 도입하므로써 `안전한`코드를 작성할 수 있다는 장점이 생긴다. 이번에는 다음과 같은 순서로 타입스크립트가 어떻게 타입을 검사하는지 알아보려고 한다.
- 타입이 무엇일까?
- 타입스크립트는 어떻게 타입을 검사할까?
- structual type

---

### 타입이 무엇일까?
먼저 타입이 무엇인지 알아야한다. 프로그램은 결국엔 값(상태)들을 제어하고 연산하여 원하는 결과를 도출해내는 것이다. 이러한 값들을 변수에 저장하는데, 변수에 저장된 값이 어떤 값이냐에 따라서 행해질 수 있는 행동들이 존재한다. 

예를 들어, 자바스크립트에서는 소문자 'a'에 toUpperCase()라는 메서드를 통해 대문자 'A'로 변환시킬 수 있다. 하지만 정수는 할 수 없는 행동이다. 이처럼 타입은 `값의 형태와 해당 값으로 할 수 있는 행동의 집합`이라고 할 수 있다. 

---

### 타입스크립트는 언제 타입을 검사할까?
자바스크립트는 추상 구문 트리로 파싱한 후에 하위 언어인 바이트 코드로 변환한다. 이후 런타임 환경에서 평가되어 실행된다. 그렇다면 타입스크립트는 어떻게 실행될 수 있을까?


타입스크립트도 자바스크립트와 유사한 과정을 거치게된다. 먼저 타입스크립트의 소스코드를 추상 구문 트리로 파싱한다. 이후 `타입검사기`를 통해 코드의 타입 안정성을 평가한다. 성공적으로 평가가 되었으면 타입스크립트의 추상 구문 트리가 자바스크립트 소스 코드로 변환하게 된다. 이후 과정은 자바스크립트의 실행과정과 같다.


따라서 자바스크립트가 런타임 환경에 실행되기 전에 타입검사기를 통해 타입을 먼저 확인하게 된다. 즉, 자바스크립트는 런타임 환경에서 타입을 검사하지만 타입스크립트는 컴파일 과정에서 검사하므로 더 안정적이라고 할 수 있다.

---

### structual type (구조 기반 타입화)
타입스크립트는 구조 기반 타입을 갖도록 설계되었다. 아래에서 코드와 함께 자세히 알아보겠지만 구조 기반은 객체의 이름에 상관없이 구조(어떤 프로퍼티를 갖고있는지)를 보고 타입을 평가한다는 것이다.


다음의 코드를 보자. Person이라는 타입을 만들었으며 해당 타입에는 string타입의 name과, number타입의 age 프로퍼티가 포함된다. 
```typescript
interface Person {
  name: string;
  age: number;
}

const printName = (person: Person) => {
  return person.name;
};

const obj = {
  name: "kim",
  age: 25,
  grade: "A",
};

console.log(printName(obj));
```

printName 함수는 Person 타입을 갖는 객체를 전달받아 name을 반환하는 함수이다. 이때 name, age, grade 프로퍼티를 갖는 obj를 함수에 전달하면 어떻게 될까? Person 타입은 grade라는 타입이 없기 때문에 에러가 발생할까?


그렇지않다. name과 age라는 프로퍼티(타입도 일치한)가 존재하는 것을 보고 에러가 발생하지 않는다. 이처럼 객체의 이름이 아닌 어떤 프로퍼티를 갖고있는지 판단하여 타입을 검사하는 것을 구조 기반 타입화라고 한다.

---

