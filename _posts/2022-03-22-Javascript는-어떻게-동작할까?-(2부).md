---
layout: post
title: Javascript는 어떻게 동작할까? (2부)
categories: [Javascript]
tags: []
fullview: false
comments: true
---

### Intro
[1부](https://4kimball.github.io/javascript/2022/03/21/Javascript%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%A0%EA%B9%8C-(1%EB%B6%80).html)에서는 런타임 환경에서 자바스크립트 코드가 어떻게 실행될 수 있는지 알아봤습니다.
2부에서는 자바스크립트 코드가 `V8`엔진에 의해 어떻게 해석되고 실행될 수 있는지 자세히 알아보려고 합니다. 해당 내용을 공부하면서 용어 또는 개념에 대한 정확한 이해가 필수적이었습니다. 따라서 V8엔진이 실행되는 전체적인 과정을 대략 설명하고 각 과정을 자세히 정리하려고 합니다.
이 과정에서 개인적으로 중요하다고 생각하는 개념에 대한 설명도 함께 정리하였습니다. 

2부에서 V8엔진을 이해한다면 각자가 생각하는 "좋은 코드"에 더 가까이 다가갈 수 있지 않을까 생각합니다. 예를 들어, 객체의 프로퍼티를 업데이트할 때 프로퍼티의 순서를 처음과 다르게 하면 안되는 이유를 이해하고 본인이 코드를 작성할 때 유의하면서 작성할 수 있을 것입니다.

---

### V8 엔진은 무엇일까?
먼저 V8엔진이 무엇인지 알아야합니다. V8은 구글이 웹 브라우저에서 자바스크립트의 수행 속도를 개선하기 위해 C++로 개발한 웹 어셈블리 엔진입니다. 현재 Chrome과 Node.js에서 사용되고 있습니다. 
우리가 자바스크립트와 같은 고급 언어로 작성된 코드는 컴퓨터가 이해할 수 없기 때문에 컴퓨터가 이해할 수 있는 언어로 변환을 해줘야합니다. 이때, V8은 자바스크립트 코드를 가상머신이 이해할 수 있는 `바이트 코드`로 변환해줍니다. (아래에서 바이트 코드에 대해 좀 더 자세하게 정리하였습니다.)

---

### V8이 자바스크립트 코드를 해석하는 과정
먼저 V8엔진이 자바스크립트 코드를 어떻게 해석하는 간략하게 알아보겠습니다. 다음은 해석 과정을 순차적으로 나열한 것입니다.
1. 파서를 통해 자바스크립트 코드를 파싱하여 `추상 구문 트리(Abstract Syntax Tree)`로 변환합니다.
2. 인터프리터인 `이그니션`이 AST를 통해 `바이트 코드`로 변환시킵니다.
3. 자주 사용되는 코드를 `터보팬`으로 보내 최적화된 코드로 컴파일합니다.

이제는 각각의 단계를 자세하게 알아보도록 하겠습니다.

---

### 파싱
파싱을 하여 `추상 구문 트리`로 변환하는데 왜 파싱이라는 과정을 거칠까요?

---

### 이그니션
이그니션은 추상 구문 트리를 통해 바이트 코드로 변환하는 인터프리터입니다. v5.9이전에는 이그니션이 아닌 `풀코드젠`을 통해 바이트코드로 변환했습니다.
풀코드젠은 한 번에 전체 소스코드를 컴파일했습니다. 하지만 자바스크립트는 동적으로 타입을 결정하는 언어이기 때문에 코드가 실행되기 전에 알 수 없는 것들이 많았으며 컴파일할 때 메모리 점유율이 높다는 단점을 갖고 잇었습니다.

따라서 이를 대체하기 위해 이그니션이라는 인터프리터가 나오게 되었습니다. 이그니션은 한 줄씩 실행될 때마다 컴파일을 진행하여 풀코드젠의 문제점을 해결하였습니다.
먼저 풀코드젠으로 컴파일하여 기계어로 해석하는 것보다 이그니션을 통해 바이트 코드를 얻는 것이 메모리 사용량을 감소시킬 수 있었으며, Optimizing이나 Deoptimizing을 할 때 바이트 코드만을 사용하면 되기 때문에 효율적입니다.

```text
바이트 코드?
```
